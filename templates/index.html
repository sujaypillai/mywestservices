<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Services Explorer | Malaysia West</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Light theme */
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --accent-primary: #0ea5e9;
            --accent-secondary: #6366f1;
            --accent-tertiary: #8b5cf6;
            --accent-glow: rgba(14, 165, 233, 0.15);
            --card-bg: rgba(255, 255, 255, 0.8);
            --glass-bg: rgba(255, 255, 255, 0.6);
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.12);
            --gradient-hero: linear-gradient(135deg, #0ea5e9 0%, #6366f1 50%, #8b5cf6 100%);
            --gradient-mesh: radial-gradient(at 40% 20%, rgba(14, 165, 233, 0.15) 0px, transparent 50%),
                            radial-gradient(at 80% 0%, rgba(99, 102, 241, 0.1) 0px, transparent 50%),
                            radial-gradient(at 0% 50%, rgba(139, 92, 246, 0.1) 0px, transparent 50%);
        }

        [data-theme="dark"] {
            --bg-primary: #0a0e1a;
            --bg-secondary: #111827;
            --bg-tertiary: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-color: #1e293b;
            --accent-glow: rgba(14, 165, 233, 0.25);
            --card-bg: rgba(17, 24, 39, 0.8);
            --glass-bg: rgba(17, 24, 39, 0.6);
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.2);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.4);
            --gradient-mesh: radial-gradient(at 40% 20%, rgba(14, 165, 233, 0.12) 0px, transparent 50%),
                            radial-gradient(at 80% 0%, rgba(99, 102, 241, 0.08) 0px, transparent 50%),
                            radial-gradient(at 0% 50%, rgba(139, 92, 246, 0.08) 0px, transparent 50%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Plus Jakarta Sans', -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .noise-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.02;
            z-index: 1000;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        }

        /* Hero Section */
        .hero {
            position: relative;
            padding: 3rem 0 4rem;
            background: var(--gradient-mesh), var(--bg-primary);
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--gradient-hero);
            opacity: 0.5;
        }

        .hero-grid {
            position: absolute;
            inset: 0;
            background-image: 
                linear-gradient(var(--border-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--border-color) 1px, transparent 1px);
            background-size: 60px 60px;
            opacity: 0.3;
            mask-image: radial-gradient(ellipse at center, black 20%, transparent 70%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
            z-index: 1;
        }

        .hero-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .hero-title {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .logo-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border-color);
            border-radius: 100px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-secondary);
            width: fit-content;
        }

        .logo-badge i {
            color: var(--accent-primary);
        }

        h1 {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            font-weight: 800;
            letter-spacing: -0.03em;
            line-height: 1.3;
            padding-bottom: 0.1em;
            background: var(--gradient-hero);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-subtitle {
            font-size: 1.125rem;
            color: var(--text-secondary);
            max-width: 650px;
        }

        .hero-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            transition: all 0.2s ease;
        }

        .theme-toggle:hover {
            border-color: var(--accent-primary);
            box-shadow: 0 0 20px var(--accent-glow);
        }

        .region-badge {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.25rem;
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
        }

        .region-dot {
            width: 10px;
            height: 10px;
            background: #22c55e;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.1); }
        }

        .region-info {
            display: flex;
            flex-direction: column;
        }

        .region-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
        }

        .region-name {
            font-weight: 700;
            font-size: 0.9rem;
        }

        /* Stats Grid */
        .stats-section {
            margin-top: -2rem;
            position: relative;
            z-index: 2;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .stat-card {
            background: var(--card-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 2rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-hero);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-primary);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: var(--accent-glow);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--accent-primary);
            margin-bottom: 1.25rem;
        }

        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 3rem;
            font-weight: 600;
            letter-spacing: -0.02em;
            line-height: 1;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
        }

        /* Toolbar */
        .toolbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1.5rem;
            margin: 3rem 0 2rem;
            flex-wrap: wrap;
        }

        .search-container {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 1rem 1.25rem 1rem 3.25rem;
            border-radius: 14px;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            font-family: inherit;
            font-size: 0.95rem;
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 4px var(--accent-glow);
        }

        .search-icon {
            position: absolute;
            left: 1.125rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        .toolbar-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.875rem 1.5rem;
            border-radius: 12px;
            font-family: inherit;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--gradient-hero);
            color: white;
            box-shadow: 0 4px 16px var(--accent-glow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px var(--accent-glow);
        }

        .btn-secondary {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            border-color: var(--accent-primary);
            background: var(--accent-glow);
        }

        /* Services Section */
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-title i {
            color: var(--accent-primary);
        }

        .services-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding-bottom: 6rem;
        }

        .provider-card {
            background: var(--card-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .provider-card:hover {
            border-color: rgba(14, 165, 233, 0.3);
        }

        .provider-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.25rem 1.5rem;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .provider-header:hover {
            background: var(--accent-glow);
        }

        .provider-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .provider-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--gradient-hero);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
        }

        .provider-name {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .provider-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .provider-count {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            padding: 0.35rem 0.75rem;
            background: var(--bg-tertiary);
            border-radius: 8px;
            color: var(--text-secondary);
        }

        .provider-toggle {
            color: var(--text-muted);
            transition: transform 0.3s ease;
        }

        .provider-toggle.expanded {
            transform: rotate(180deg);
        }

        .provider-services {
            display: none;
            padding: 0 1.5rem 1.5rem;
            border-top: 1px solid var(--border-color);
        }

        .provider-services.open {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 0.75rem;
            padding-top: 1.25rem;
        }

        .service-item {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 1rem;
            padding: 1rem 1.25rem;
            background: var(--bg-tertiary);
            border-radius: 10px;
            border: 1px solid transparent;
            transition: all 0.2s ease;
        }

        .service-item:hover {
            border-color: var(--accent-primary);
            background: var(--accent-glow);
        }

        .service-name {
            font-weight: 600;
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }

        .service-path {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--text-muted);
            word-break: break-all;
        }

        .service-version {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.65rem;
            padding: 0.25rem 0.5rem;
            background: var(--bg-secondary);
            border-radius: 6px;
            color: var(--text-muted);
            white-space: nowrap;
        }

        /* Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 100;
        }

        .chat-trigger {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-hero);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 8px 32px rgba(14, 165, 233, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-trigger:hover {
            transform: scale(1.08);
            box-shadow: 0 12px 40px rgba(14, 165, 233, 0.5);
        }

        .chat-panel {
            display: none;
            position: fixed;
            bottom: 100px;
            right: 24px;
            width: 420px;
            max-height: 600px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            flex-direction: column;
        }

        .chat-panel.open {
            display: flex;
            animation: chatSlideUp 0.3s ease;
        }

        @keyframes chatSlideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chat-header {
            background: var(--gradient-hero);
            color: white;
            padding: 1.25rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .chat-header-icon {
            width: 36px;
            height: 36px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-header-title {
            font-weight: 700;
            font-size: 1rem;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
            max-height: 380px;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            max-width: 85%;
            padding: 1rem 1.25rem;
            border-radius: 16px;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .message.user {
            background: var(--gradient-hero);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .message.bot {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            margin-right: auto;
            border-bottom-left-radius: 4px;
        }

        .message ul {
            margin: 0.75rem 0 0 1rem;
            padding: 0;
        }

        .message li {
            margin-bottom: 0.35rem;
        }

        .chat-input-area {
            padding: 1rem 1.5rem 1.5rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 0.75rem;
        }

        .chat-input {
            flex: 1;
            padding: 0.875rem 1.25rem;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        .chat-send {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: var(--gradient-hero);
            border: none;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .chat-send:hover {
            transform: scale(1.05);
        }

        .loading-dots {
            display: inline-flex;
            gap: 4px;
        }

        .loading-dots span {
            width: 8px;
            height: 8px;
            background: var(--accent-primary);
            border-radius: 50%;
            animation: dotPulse 1.4s infinite;
        }

        .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
        .loading-dots span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes dotPulse {
            0%, 80%, 100% { transform: scale(0.6); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-content {
                flex-direction: column;
            }
            
            .hero-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .chat-panel {
                width: calc(100% - 48px);
                right: 24px;
                left: 24px;
            }
            
            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-container {
                max-width: 100%;
            }
            
            .toolbar-actions {
                justify-content: flex-end;
            }
            
            .services-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* Disclaimer Banner */
        .disclaimer-banner {
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
            padding: 0.75rem 0;
            text-align: center;
        }

        .disclaimer-text {
            font-size: 0.8rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .disclaimer-text i {
            color: #f59e0b;
        }

        /* Footer */
        .footer {
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: 2rem 0;
            margin-top: 4rem;
        }

        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            text-align: center;
        }

        .footer-disclaimer {
            font-size: 0.75rem;
            color: var(--text-muted);
            max-width: 800px;
            line-height: 1.6;
            padding: 1rem;
            background: var(--bg-tertiary);
            border-radius: 8px;
            border-left: 3px solid #f59e0b;
        }

        .footer-links {
            display: flex;
            gap: 1.5rem;
            font-size: 0.85rem;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s;
        }

        .footer-links a:hover {
            color: var(--accent-primary);
        }

        .footer-copyright {
            font-size: 0.75rem;
            color: var(--text-muted);
        }
    </style>
</head>
<body>
    <div class="noise-overlay"></div>

    <!-- Disclaimer Banner -->
    <div class="disclaimer-banner">
        <div class="container">
            <p class="disclaimer-text">
                <i class="bi bi-info-circle-fill"></i>
                This is an unofficial community project. Not affiliated with or endorsed by Microsoft.
            </p>
        </div>
    </div>

    <!-- Hero Section -->
    <header class="hero">
        <div class="hero-grid"></div>
        <div class="container">
            <div class="hero-content">
                <div class="hero-title">
                    <div class="logo-badge">
                        <i class="bi bi-cloud-fill"></i>
                        Azure Services Explorer
                    </div>
                    <h1>Malaysia West Region Services</h1>
                    <p class="hero-subtitle">Explore and discover all Azure services available in the Malaysia West region. Real-time data powered by Azure Resource Manager.</p>
                </div>
                <div class="hero-actions">
                    <div class="region-badge">
                        <div class="region-dot"></div>
                        <div class="region-info">
                            <span class="region-label">Active Region</span>
                            <span class="region-name">Malaysia West</span>
                        </div>
                    </div>
                    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
                        <i class="bi bi-moon-fill" id="themeIcon"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Stats Section -->
    <section class="stats-section">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="bi bi-box-seam"></i>
                    </div>
                    <div class="stat-value">{{ total_count }}</div>
                    <div class="stat-label">Total Resource Types</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="bi bi-building"></i>
                    </div>
                    <div class="stat-value">{{ provider_count }}</div>
                    <div class="stat-label">Service Providers</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="bi bi-lightning-charge"></i>
                    </div>
                    <div class="stat-value">100%</div>
                    <div class="stat-label">API Availability</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">
        <!-- Toolbar -->
        <div class="toolbar">
            <div class="search-container">
                <i class="bi bi-search search-icon"></i>
                <input type="text" class="search-input" id="searchInput" placeholder="Search services by name or provider...">
            </div>
            <div class="toolbar-actions">
                <a href="/api/export/csv" class="btn btn-secondary">
                    <i class="bi bi-download"></i>
                    Export CSV
                </a>
                <button class="btn btn-primary" onclick="toggleChat()">
                    <i class="bi bi-robot"></i>
                    Ask AI
                </button>
            </div>
        </div>

        <!-- Services -->
        <div class="section-header">
            <h2 class="section-title">
                <i class="bi bi-grid-3x3-gap"></i>
                Available Services
            </h2>
        </div>

        <div class="services-container" id="servicesContainer">
            {% for provider, provider_services in grouped_services.items() %}
            <div class="provider-card" data-provider="{{ provider.lower() }}">
                <div class="provider-header" onclick="toggleProvider('{{ provider }}')">
                    <div class="provider-info">
                        <div class="provider-icon">
                            <i class="bi bi-microsoft"></i>
                        </div>
                        <span class="provider-name">{{ provider }}</span>
                    </div>
                    <div class="provider-meta">
                        <span class="provider-count">{{ provider_services|length }} services</span>
                        <i class="bi bi-chevron-down provider-toggle" id="toggle-{{ provider }}"></i>
                    </div>
                </div>
                <div class="provider-services" id="services-{{ provider }}">
                    <div class="services-grid">
                        {% for service in provider_services %}
                        <div class="service-item" data-name="{{ service.display_name.lower() }}">
                            <div>
                                <div class="service-name">{{ service.resource_type }}</div>
                                <div class="service-path">{{ service.display_name }}</div>
                            </div>
                            {% if service.api_versions %}
                            <span class="service-version">{{ service.api_versions[0] }}</span>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </main>

    <!-- Chat Widget -->
    <div class="chat-widget">
        <div class="chat-panel" id="chatPanel">
            <div class="chat-header">
                <div class="chat-header-icon">
                    <i class="bi bi-robot"></i>
                </div>
                <span class="chat-header-title">Ask about Azure Services</span>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="message bot">
                    üëã Hi! I can help you explore Azure services in Malaysia West. Try asking:
                    <ul>
                        <li>Is Azure SQL available?</li>
                        <li>What storage options are there?</li>
                        <li>List all compute services</li>
                    </ul>
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" class="chat-input" id="chatInput" placeholder="Type your question..." onkeypress="if(event.key==='Enter') sendMessage()">
                <button class="chat-send" onclick="sendMessage()">
                    <i class="bi bi-send-fill"></i>
                </button>
            </div>
        </div>
        <button class="chat-trigger" onclick="toggleChat()">
            <i class="bi bi-chat-dots-fill" id="chatIcon"></i>
        </button>
    </div>

    <script>
        // Theme Toggle
        function toggleTheme() {
            const html = document.documentElement;
            const icon = document.getElementById('themeIcon');
            const currentTheme = html.getAttribute('data-theme');
            
            if (currentTheme === 'dark') {
                html.setAttribute('data-theme', 'light');
                icon.className = 'bi bi-sun-fill';
                localStorage.setItem('theme', 'light');
            } else {
                html.setAttribute('data-theme', 'dark');
                icon.className = 'bi bi-moon-fill';
                localStorage.setItem('theme', 'dark');
            }
        }

        // Load saved theme
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            const icon = document.getElementById('themeIcon');
            icon.className = savedTheme === 'dark' ? 'bi bi-moon-fill' : 'bi bi-sun-fill';
        })();

        // Provider Toggle
        function toggleProvider(provider) {
            const services = document.getElementById(`services-${provider}`);
            const toggle = document.getElementById(`toggle-${provider}`);
            
            services.classList.toggle('open');
            toggle.classList.toggle('expanded');
        }

        // Search
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const query = e.target.value.toLowerCase();
            const providers = document.querySelectorAll('.provider-card');
            
            providers.forEach(provider => {
                const services = provider.querySelectorAll('.service-item');
                let visibleCount = 0;
                
                services.forEach(service => {
                    const name = service.dataset.name;
                    if (name.includes(query)) {
                        service.style.display = 'flex';
                        visibleCount++;
                    } else {
                        service.style.display = 'none';
                    }
                });
                
                provider.style.display = visibleCount > 0 ? 'block' : 'none';
                
                if (visibleCount > 0 && query) {
                    const servicesContainer = provider.querySelector('.provider-services');
                    const toggle = provider.querySelector('.provider-toggle');
                    servicesContainer.classList.add('open');
                    toggle.classList.add('expanded');
                }
            });
        });

        // Chat
        function toggleChat() {
            const panel = document.getElementById('chatPanel');
            const icon = document.getElementById('chatIcon');
            panel.classList.toggle('open');
            
            if (panel.classList.contains('open')) {
                icon.className = 'bi bi-x-lg';
                document.getElementById('chatInput').focus();
            } else {
                icon.className = 'bi bi-chat-dots-fill';
            }
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const question = input.value.trim();
            
            if (!question) return;
            
            const messages = document.getElementById('chatMessages');
            
            messages.innerHTML += `<div class="message user">${escapeHtml(question)}</div>`;
            input.value = '';
            
            messages.innerHTML += `<div class="message bot" id="loading"><div class="loading-dots"><span></span><span></span><span></span></div></div>`;
            messages.scrollTop = messages.scrollHeight;
            
            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ question })
                });
                
                const data = await response.json();
                
                document.getElementById('loading').remove();
                messages.innerHTML += `<div class="message bot">${formatResponse(data.answer)}</div>`;
                
            } catch (error) {
                document.getElementById('loading').remove();
                messages.innerHTML += `<div class="message bot" style="color: #ef4444;">Sorry, something went wrong. Please try again.</div>`;
            }
            
            messages.scrollTop = messages.scrollHeight;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function formatResponse(text) {
            return escapeHtml(text)
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n/g, '<br>');
        }
    </script>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-disclaimer">
                    <strong>‚ö†Ô∏è Disclaimer:</strong> This website is an independent, community-driven project and is not officially affiliated with, endorsed by, or connected to Microsoft Corporation or Microsoft Azure. The information displayed is fetched dynamically from Azure Resource Manager APIs and may not reflect the most current availability. For official and authoritative information about Azure services, please visit <a href="https://azure.microsoft.com" target="_blank" rel="noopener">azure.microsoft.com</a>.
                </div>
                <div class="footer-links">
                    <a href="https://azure.microsoft.com/en-us/explore/global-infrastructure/products-by-region/" target="_blank" rel="noopener">Official Azure Products by Region</a>
                    <a href="https://github.com/sujaypillai/mywestservices" target="_blank" rel="noopener"><i class="bi bi-github"></i> Source Code</a>
                </div>
                <div class="footer-copyright">
                    ¬© 2026 Azure Services Explorer. Open source project.
                </div>
            </div>
        </div>
    </footer>
</body>
</html>
